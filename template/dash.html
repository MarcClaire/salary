{% extends 'layout/Layout.html' %}
<!-- Page Heading -->
{% load static %}
{% block content %}

<div class="row">
    <!-- Structures Section -->
    <div class="col-xl-6 col-lg-6">
        <div class="card shadow mb-4">
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">Structures</h6>
                <div class="dropdown no-arrow">
                    <a class="" href="#" role="button" id="dropdownMenuLink">
                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                    </a>
                </div>
            </div>
            <div class="card-body row">
                <div class="col-7">
                    <img src="{% static 'img/bulding.png' %}" class="img-fluid" alt="Responsive image"
                        style="width: 38%;">
                </div>
                <div class="col-5 my-auto">
                    <ul class="list-group">
                        <li class="list-group-item">Total: {{total_structure}}</li>
                        <li class="list-group-item"><a href="{% url 'structure' %}"><i class="fa fa-eye"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Employés Section -->
    <div class="col-xl-6 col-lg-6">
        <div class="card shadow mb-4">
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">Employés</h6>
                <div class="dropdown no-arrow">
                    <a class="" href="#" role="button" id="dropdownMenuLink">
                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                    </a>
                </div>
            </div>
            <div class="card-body row">
                <div class="col-7 my-auto">
                    <img src="{% static 'img/construction-worker.png' %}" class="img-fluid" alt="Responsive image"
                        style="width: 37%;">
                </div>
                <div class="col-5">
                    <ul class="list-group">
                        <li class="list-group-item">Total: <em>{{total_employe}}</em> ( CDD: <em>{{total_cdd}}</em> /
                            CDI: <em>{{total_cdi}}</em> )</li>
                        <li class="list-group-item"><a href="{% url 'personel' %}"><i class="fa fa-eye"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Nouvelle section : Employés dont le contrat expire dans 30 jours -->
<div class="row">
    <div class="col-xl-12 col-lg-12">
        <div class="card shadow mb-4">
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">Contrats expirant dans 30 jours</h6>
            </div>
            <div class="card-body">
                {% if contrats %}
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Employé</th>
                            <th>Poste</th>
                            <th>Date de début</th>
                            <th>Date de fin</th>
                            <th>Lieu d'affectation</th>
                            <th>Type de contrat</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for contrat in contrats %}
                        <tr>
                            <td>{{ contrat.employe }}</td>
                            <td>{{ contrat.poste }}</td>
                            <td>{{ contrat.date_debut }}</td>
                            <td>{{ contrat.date_fin }}</td>
                            <td>{{ contrat.lieu_affectation }}</td>
                            <td>{{ contrat.type_contrat }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p>Aucun contrat ne se termine dans les 30 prochains jours.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endblock %}